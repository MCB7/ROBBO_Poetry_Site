(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(9862)}])},9862:function(e,n,t){"use strict";let i;t.r(n),t.d(n,{default:function(){return _}});var o=t(5893),r=t(7294),a=t(4866);t(8522),t(6282),a.Z.apps.length||a.Z.initializeApp({apiKey:"AIzaSyDW-LusqTgA-3azW90OWcEjwdmNi_ey8Bo",authDomain:"robbo-website.firebaseapp.com",projectId:"robbo-website",storageBucket:"nextjs-image-gallery.appspot.com",messagingSenderId:"704772881190",appId:"1:704772881190:web:7b438e7a2be5995fc8dfe7",measurementId:"G-DHVQ322SVE"});var s=a.Z;function l(e){let{}=e;async function n(){let e=await s.auth().signInWithPopup(new s.auth.GoogleAuthProvider);console.log({...e.user}),s.firestore().collection("users").doc(e.user.uid).set({uid:e.user.uid,email:e.user.email,name:e.user.displayName,provider:e.user.providerData[0].providerId,photoUrl:e.user.photoURL})}return(0,o.jsx)("div",{children:(0,o.jsx)("button",{onClick:()=>n(),children:"Sign in with Google"})})}var c=t(9860),u=t(4465);let d=async()=>(i||(i=await (0,u.J)("pk_test_51Mq002J523EziYg9bq8pwG7z2raFO23J42PHaeWBI5iuUMmmVOD2ySlUX8g3E3dlPW90YmES0mUGLKuEP7RgeSEa00S2Lqgx1q")),i);async function p(e){let n=s.firestore(),t=await n.collection("users").doc(e).collection("checkout_sessions").add({price:"price_1MqNOAJ523EziYg9CxoYJEWG",success_url:window.location.origin,cancel_url:window.location.origin});t.onSnapshot(async e=>{let{sessionId:n}=e.data();if(n){let e=await d();null==e||e.redirectToCheckout({sessionId:n})}})}async function h(){var e,n,t;await (null===(e=s.auth().currentUser)||void 0===e?void 0:e.getIdToken(!0));let i=await (null===(n=s.auth().currentUser)||void 0===n?void 0:n.getIdTokenResult());return null!=i&&null!==(t=i.claims)&&void 0!==t&&!!t.stripeRole}var g=t(7004);let f=s.app();async function w(){let e=(0,g.$C)(f,"us-central1"),n=(0,g.V1)(e,"ext-firestore-stripe-payments-createPortalLink");n({returnUrl:"".concat(window.location.origin,"/account")}).then(e=>{e.data})}let m=()=>(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("button",{onClick:()=>{w()},children:"Manage Billing"})});function _(){let[e,n]=(0,c.F_)(s.auth()),t=function(e){let[n,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(e){let e=async function(){t(await h())};e()}},[e]),n}(e);return(0,o.jsxs)(o.Fragment,{children:[!e&&n&&(0,o.jsx)("h1",{children:" loading..."}),!e&&!n&&(0,o.jsx)(l,{}),e&&!n&&(0,o.jsxs)("div",{children:[(0,o.jsxs)("h1",{children:["Hello, ",e.displayName]}),t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h2",{children:"thank you!"}),(0,o.jsx)(m,{})]}):(0,o.jsx)("button",{onClick:()=>p(e.uid),children:"Buy Zine"})]})]})}}},function(e){e.O(0,[16,754,558,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);